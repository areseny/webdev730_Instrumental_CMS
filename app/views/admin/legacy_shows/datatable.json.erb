<% cache "legacy-shows-datatable", skip_digest: true do %>
{
  "aaData": [
    <%= raw(@legacy_shows.map do |legacy_show|
      date = link_to l(legacy_show.date, format: :brief), edit_admin_legacy_show_path(legacy_show)
      description = admin_json_description(legacy_show)
      total_songs = legacy_show.songs.count
      if total_songs > 0
        songs_link = link_to("#{total_songs} mÃºsicas", admin_legacy_show_songs_path(legacy_show))
      else
        songs_link = content_tag(:span, "Nenhuma")
      end
      [date, legacy_show.artist.name, songs_link, description, legacy_show.date.to_time.to_i].to_json
    end.join(',')) %>
  ]
}
<% end -%>
